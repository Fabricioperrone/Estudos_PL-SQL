--Capitulo 25

SELECT COD_ALUNO, Trunc(DATA),
        Sum(DESCONTO) DESCONTO,
        Sum(TOTAL) TOTAL
FROM    TCONTRATO
GROUP BY ROLLUP(COD_ALUNO, Trunc(DATA));

--
SELECT COD_ALUNO,
      CASE
        WHEN Trunc(DATA) IS NULL AND COD_ALUNO IS NOT NULL
          THEN 'SUB-TOTAL'
        WHEN COD_ALUNO IS NULL
          THEN'TOTAL'
        ELSE To_Char(Trunc(DATA))
        END DESCRICAO,
        Round(Avg(DESCONTO),2) DESCONTO,
        Sum(TOTAL) TOTAL
FROM    TCONTRATO
GROUP BY ROLLUP(COD_ALUNO, Trunc(DATA) );
